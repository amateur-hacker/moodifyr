// lib/loadYouTube.ts
export function loadYouTubeAPI(): Promise<typeof YT> {
  return new Promise((resolve) => {
    if (typeof window === "undefined") return;

    // Already loaded
    if (window.YT && window.YT.Player) {
      return resolve(window.YT);
    }

    // Create script tag if not present
    const tagId = "youtube-iframe-api";
    if (!document.getElementById(tagId)) {
      const tag = document.createElement("script");
      tag.src = "https://www.youtube.com/iframe_api";
      tag.id = tagId;
      document.body.appendChild(tag);
    }

    // Wait for API ready
    (window as any).onYouTubeIframeAPIReady = () => {
      resolve(window.YT);
    };
  });
}
